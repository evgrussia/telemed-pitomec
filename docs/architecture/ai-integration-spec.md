---
title: "Спецификация интеграции ИИ: Телемед-Питомец"
created_by: "AI-Agents Agent"
created_at: "2026-01-28"
status: "Draft"
---

# Спецификация интеграции ИИ (AI Integration Spec)

Данный документ описывает архитектуру, компоненты и процессы ИИ-составляющей сервиса «Телемед-Питомец». Основная задача системы — обеспечить быструю и точную сортировку (триаж) обращений пользователей на основе визуальных данных.

## 1. Архитектура пайплайна

Обработка запроса пользователя проходит через многостадийный пайплайн для обеспечения надежности и точности.

### 1.1 Этапы пайплайна

1. **Загрузка и Валидация (Input & Validation):**
   - Прием изображения от пользователя (через Telegram WebApp).
   - Проверка качества (blur detection, exposure check).
   - Binary Classification: «Есть ли на фото животное?» и «Является ли это медицинским симптомом?».

2. **Препроцессинг (Preprocessing):**
   - Изменение размера (Resizing) под требования моделей.
   - Нормализация цветов.
   - Анонимизация (удаление лиц людей, если они попали в кадр).

3. **Классификация и Локализация (Classification & Localization):**
   - **Species Detection:** Определение вида животного (собака, кошка, экзот).
   - **Symptom Localization (Object Detection/Segmentation):** Выделение области поражения (глаз, кожа, лапа, ротовая полость).
   - **Symptom Classification:** Предварительная классификация типа проблемы (дерматит, конъюнктивит, травма и т. д.).

4. **Анализ и Триаж (Reasoning & Triage):**
   - Интеграция визуальных признаков с текстовым описанием от пользователя.
   - Определение степени срочности (Triage Level).

5. **Генерация Отчета (Reporting):**
   - Формирование структурированного вывода для владельца и технического summary для ветеринара.

## 2. Выбор моделей и подходов

Для баланса между скоростью, стоимостью и точностью используется гибридная архитектура.

### 2.1 Специализированные модели (Computer Vision)

Для быстрых и дешевых проверок на начальных этапах:

- **Архитектура:** EfficientNet-B0 или MobileNetV3 (оптимизированы для мобильного инференса).
- **Задачи:** Валидация входных данных, Species Detection, предварительная локализация симптомов.
- **Преимущество:** Низкая задержка (< 500 мс), возможность развертывания на собственных серверах (self-hosted).

### 2.2 Мультимодальные LLM (VLM - Vision Language Models)

Для глубокого анализа и принятия решений о триаже:

- **Модели:** Claude 3.5 Sonnet / GPT-4o или специализированные медицинские VLM (если доступны).
- **Задачи:** Связывание визуальных признаков с контекстом пользователя, оценка рисков, формирование рекомендаций.
- **Prompting Strategy:** Few-shot prompting с примерами ветеринарных кейсов и жесткими системными инструкциями по безопасности.

## 3. Формат вывода (Output)

Результат работы ИИ разделяется на два типа представления в зависимости от целевой аудитории.

### 3.1 Для пользователя (Owner View)

Цель: Снизить тревожность, дать четкие инструкции.

- **Triage Status:** Цветовой индикатор (Зеленый / Желтый / Красный).
- **Краткое пояснение:** «Похоже на аллергическую реакцию. Не является экстренным случаем, но требует наблюдения».
- **Next Steps:** «Рекомендуем записаться на онлайн-консультацию в течение 24 часов» или «Срочно обратитесь в ближайшую клинику».
- **Disclaimer:** Обязательное уведомление, что это не окончательный диагноз.

### 3.2 Для ветеринара (Vet View)

Цель: Подготовить врача к консультации, сэкономить время на сборе анамнеза.

- **Confidence Scores:** Уверенность модели в определении вида и типа симптома.
- **Symptom Map:** Изображение с выделенными зонами интереса (Bounding Boxes).
- **Technical Summary:** Перечень обнаруженных визуальных признаков (например: «гиперемия конъюнктивы», «серозные выделения»).
- **Urgency Score:** Оценка срочности от 1 до 10 на основе протоколов триажа.

## 4. Метрики и логика валидации

Система требует постоянного контроля качества, так как ошибки могут влиять на здоровье питомцев.

### 4.1 Ключевые метрики

- **Triage Recall (Критическая):** Способность системы не пропустить «красные» (экстренные) случаи. Цель: **> 98%**.
- **Triage Precision:** Снижение количества ложноположительных «красных» тревог (чтобы не перегружать врачей). Цель: **> 85%**.
- **Species/Symptom Accuracy:** Точность классификации. Цель: **> 90%**.
- **Inference Latency:** Полное время обработки (E2E). Цель: **< 10 сек**.

### 4.2 Логика валидации (Human-in-the-Loop)

1. **Golden Dataset:** Постоянно обновляемая база из 1000+ проверенных ветеринарами кейсов для регрессионного тестирования.
2. **Expert Review Loop:** Каждый результат ИИ, за которым последовала консультация, оценивается врачом по 5-балльной шкале (соответствие реальности).
3. **Anomaly Detection:** Автоматическая отправка на ручную проверку кейсов с низким уровнем уверенности (Confidence < 0.6).
4. **A/B Testing:** Тестирование новых версий промптов и моделей на 5% трафика перед полным деплоем.

---

Документ создан: AI-Agents Agent | Дата: 2026-01-28
