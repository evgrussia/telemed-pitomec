---
title: "Tracking Plan: Телемед-Питомец"
created_by: "Analytics Agent"
created_at: "2026-01-28"
version: "1.0"
---

# План отслеживания (Tracking Plan): Телемед-Питомец

Данный документ описывает систему измерения успеха продукта, ключевые метрики и схему событий для аналитики.

## 1. Фреймворк метрик

### North Star Metric (Метрика "Полярная звезда")
**Количество успешно решенных проблем со здоровьем питомца**
*Определяется как сумма: (AI-диагностики с высокой точностью + Завершенные консультации с ветеринаром).*

### Воронка активации (AARRR)

| Этап | Метрика | Определение | Цель (MVP) |
|------|---------|-------------|------------|
| **Acquisition** | New Users | Количество новых регистраций в Telegram WebApp | 20,000/мес |
| **Activation** | Pet Registration Rate | % пользователей, добавивших хотя бы одного питомца | > 70% |
| **Retention** | D30 Retention | % пользователей, вернувшихся в приложение через 30 дней | > 15% |
| **Service Quality** | Vet Response Time | Среднее время от оплаты до начала консультации | < 15 мин |
| **Revenue** | Conversion to Paid | % пользователей, оплативших консультацию или подписку | > 5% |
| **Referral** | Share Rate | % пользователей, переславших ссылку на бот друзьям | > 10% |

## 2. Схема событий (Event Schema)

### 2.1 Регистрация и Профиль
| Событие | Триггер | Свойства (Properties) |
|---------|---------|-----------------------|
| `user_registered` | Завершение онбординга (согласие с Terms) | `source` (utm), `tg_language` |
| `pet_added` | Успешное создание профиля питомца | `pet_type`, `pet_breed`, `pet_age`, `is_first_pet` |

### 2.2 ИИ-диагностика
| Событие | Триггер | Свойства (Properties) |
|---------|---------|-----------------------|
| `ai_diagnosis_started` | Пользователь нажал "Начать диагностику" | `pet_id`, `entry_point` |
| `ai_photo_uploaded` | Фото успешно загружено на сервер | `file_size`, `image_quality_score` |
| `ai_diagnosis_completed` | ИИ выдал результат анализа | `threat_level` (Low/Med/High), `processing_time_ms`, `suggested_category` |
| `ai_feedback_submitted` | Пользователь оценил результат ИИ | `rating` (1-5), `comment` |

### 2.3 Запись и Консультация
| Событие | Триггер | Свойства (Properties) |
|---------|---------|-----------------------|
| `consultation_initiated` | Нажатие кнопки "Записаться к врачу" | `pet_id`, `doctor_id` (если выбран), `source` (after_ai/direct) |
| `slot_selected` | Выбор времени в календаре | `slot_datetime`, `doctor_specialty` |
| `consultation_started` | Вход в видеокомнату | `connection_type`, `device_type` |
| `consultation_ended` | Завершение звонка | `duration_sec`, `end_reason` (completed/dropped) |

### 2.4 Оплата
| Событие | Триггер | Свойства (Properties) |
|---------|---------|-----------------------|
| `payment_initiated` | Переход к экрану оплаты Telegram | `amount`, `currency`, `item_type` (consultation/subscription) |
| `payment_completed` | Успешное подтверждение транзакции | `transaction_id`, `amount`, `payment_method` |

## 3. Отслеживание точности ИИ (Feedback Loop)

Для измерения качества работы ИИ-модели используется экспертная оценка ветеринаров.

### Механика сбора данных
1. Каждая диагностика ИИ сохраняется в БД с уникальным `diagnosis_id`.
2. Если после ИИ следует консультация с врачом, врачу в интерфейсе предлагается оценить корректность работы ИИ.
3. Событие: `ai_validation_submitted` (Server-side).

### Свойства события `ai_validation_submitted`
| Свойство | Тип | Описание |
|----------|-----|----------|
| `diagnosis_id` | string | Ссылка на оригинальную диагностику |
| `doctor_id` | string | ID ветеринара-эксперта |
| `is_correct` | boolean | Совпал ли вывод ИИ с мнением врача |
| `threat_level_match` | boolean | Правильно ли определена степень угрозы |
| `expert_comment` | string | Уточнение ошибки (если есть) |

### Ключевые метрики точности
*   **AI Precision:** Доля случаев, когда ИИ определил угрозу правильно (по мнению врача).
*   **AI Recall:** Доля критических случаев, которые ИИ НЕ пропустил.
*   **False Negative Rate:** Самый критичный показатель (ИИ сказал "все ок", а врач нашел проблему). Цель: **< 5%**.

## 4. Рекомендуемые инструменты

### Продуктовая аналитика (Amplitude / Mixpanel)
*   **Почему:** Лучшие инструменты для анализа воронки, когортного анализа и удержания.
*   **Рекомендация:** Amplitude (бесплатный лимит до 50k MTU) для старта.

### Самописная/Self-hosted (PostHog)
*   **Почему:** Полный контроль над данными, встроенная запись сессий и Feature Flags.
*   **Рекомендация:** Если важна приватность данных (согласно ФЗ-152), развернуть PostHog на своих серверах.

### Технический мониторинг (Sentry + Prometheus/Grafana)
*   **Sentry:** Для отслеживания ошибок в React (Frontend) и Django (Backend).
*   **Grafana:** Для мониторинга времени инференса ИИ и стабильности видеозвонков.

---
✍️ **Analytics Agent**
